# Черновик ТЗ на разработку системы

## 0. Реквизиты документа

| Параметр | Значение |
|----------|----------|
| Версия | 1.0 |
| Дата | 2025-11-06 00:00:00 |

## 1. Общая информация

| Параметр | Значение |
|----------|----------|
| Название проекта / продукта: | *не заполнено* |
| Ваше имя и должность: | Исламов Руслан. Технический писатель |
| Контакт (мессенджер): | @Rus_zem |

## 2. Описание проекта и задач

### 2.1 Проблема
Большие временные затраты на создание и актуализацию проектной и эксплуатационной документации для программного обеспечения. Отсутствие стандартизации, дублирование работы при создании схожих документов, сложность поддержания актуальности документации.

### 2.2 Цели проекта
1. Обеспечение стандартизации и единообразия документации
2. Устранение дублирования работы при создании схожих документов
3. Обеспечение актуальности документации за счет автоматического использования последних данных из источников знаний
4. Создание единого централизованного хранилища документации
5. Любая единица информация, которая было создана, должна максимально переиспользована в пайплайне документации (пайплайн разработки-внедрения продукта)
6. Возможность собрать документацию по запросу - что угодно, для кого угодно. Без привлечения штатной единицы тех.писателя
7. В любом месте продукта пользователь должен узнать всё возможное об функционале продукта, включая термины - ценность, сценарий использования, пользовательская инструкция

### 2.3 Задачи
1. Автоматизировать процесс создания технических документов по запросу на естественном языке
2. Реализовать интеграцию с корпоративными источниками знаний (Git, Confluence)
3. Внедрить систему управления жизненным циклом документов
4. Реализовать механизм повторного использования существующих документов
5. Обеспечить многоинтерфейсный доступ к системе

### 2.4 Критерии успеха
1. 100% документов соответствуют утвержденным шаблонам
2. Время генерации документа не превышает 3 минут
3. Система доступна 100% времени
4. Удовлетворенность пользователей (CSAT) ≥ 4.5/5 минимум

## 3. Функциональные требования

### 3.1 Основной сценарий
**Основной сценарий:** Пользователь → Система → Результат

Технический писатель отправляет запрос "Создай техническое задание для модуля отчетности АСУ ПГР" → Система анализирует запрос, определяет тип документа "ТЗ", извлекает релевантную информацию из Git и Confluence, генерирует структурированный документ → Пользователь получает готовый файл с техническим заданием. Расширение зависит от интерфейса (.docx для Telegram, .md для веб-интерфейса, JSON для API).

**СЦЕНАРИЙ 2: Редактирование и актуализация существующего документа**  
Пользователь → Система → Обновление источников знаний

1. Технический писатель: "Вызвать ТЗ для модуля геолокации АСУ ПГР"
2. Система: находит документ, отображает содержание
3. Технический писатель: "Исправить пункт 3.4. Добавить требование к точности позиционирования: ±5 метров в шахтных условиях"
4. Бот: вносит правки в документ, создает новую версию
5. Система: автоматически обновляет соответствующие страницы в Confluence и файлы в Git-репозитории с пометкой "Исправление требований к точности - Иванов А.И. 26.05.2024"
6. Система: переиндексирует измененные разделы в векторной БД для обеспечения актуальности поиска

**СЦЕНАРИЙ 3: Согласование и утверждение документа**  
Автор → Редактор → Утверждающий → Система

1. Автор создает документ, меняет статус на "in_review"
2. Редактор проверяет, вносит правки, оставляет комментарии
3. Утверждающий проверяет финальную версию, меняет статус на "approved"
4. Система автоматически индексирует утвержденный документ в базу знаний "approved_docs" для использования в будущих генерациях

**СЦЕНАРИЙ 4: Поиск и повторное использование документа**  
Пользователь → Система → Результат

1. Разработчик: "Нужно ТЗ для API интеграции с системой мониторинга"
2. Система находит семантически похожий документ "ТЗ для API модуля мониторинга оборудования" с коэффициентом схожести 92%
3. Система: "Найден похожий документ от 15.04.2024. Использовать как основу?"
4. Пользователь подтверждает → система создает копию документа с ссылкой на оригинал

**СЦЕНАРИЙ 5: Масштабное обновление документации при изменениях в системе**  
Событие → Система → Результат

1. В Git вносятся значительные изменения в архитектуру модуля отчетности
2. Администратор запускает процесс переиндексации: "Обновить документацию для модуля отчетности"
3. Система анализирует изменения в исходном коде, находит все связанные документы
4. Система автоматически генерирует предложения по актуализации ТЗ, руководств, регламентов
5. Технические писатели проверяют и утверждают изменения
6. Система массово обновляет документацию в Confluence и Git

### 3.2 Действия системы
1. Классификация намерений: Определение типа документа (ТЗ, руководство, описание системы, регламент и др.)
2. Нормализация запросов: Приведение различных формулировок к каноническому виду ("ТЗ", "Тех. задание", "тех.узадание", "техник.задача")
3. Семантический поиск: RAG-поиск релевантной информации в векторной БД
4. Генерация документа: Формирование промптов и генерация контента через LLM
5. Управление документами: Версионирование, контроль статусов (draft → in_review → approved → archived)
6. Кэширование: Поиск и повторное использование существующих документов
7. Модерация: Проверка запросов на соответствие корпоративным политикам

### 3.3 Каналы и UI
1. REST API: Основной программный интерфейс
2. Веб-интерфейс: React-приложение с современным UI/UX (???)
3. Telegram-бот: Временное решение
4. CLI-утилита: Для разработчиков и автоматизации

### 3.4 Интеграции
1. Git-репозитории: GitHub/GitLab API для доступа к исходному коду и документации
2. Confluence: REST API для доступа к корпоративной вики
3. Локальная LLM: Ollama API / DeepSeek/ пр. для генерации текста
4. Векторная БД: ChromaDB/Qdrant для семантического поиска
5. SQL БД: PostgreSQL для метаданных
6. Кэш: Redis для временного хранения данных

### 3.5 Входные данные
1. Текстовые запросы пользователей на естественном языке
2. Структурированные данные из Git (Markdown, текстовые файлы)
3. HTML-контент из Confluence
4. Метаданные пользователей и документов

### 3.6 Выходные данные
1. Документы в формате .docx / .pdf / .html / .md
2. Markdown-версии документов
3. Метаданные в JSON-формате
4. Статусы операций и уведомления

### 3.7 Локализация
1. Модель должна быть обучена и использовать кириллицу
2. Интерфейс на русском, на английском языке специфичные термины (опционально)
3. Генерируемый контент должен быть на русском языке. Без артефактов и битых ответов (например, "Nadejno", "Ekaterinburg")

### 3.8 Ошибки и fallback
1. При ошибках LLM - возврат сообщения об ошибке с детализацией
2. При недоступности внешних сервисов - автоматические повторные попытки
3. При непонятных запросах - уточняющие вопросы пользователю
4. Резервные механизмы классификации и поиска

### 3.9 Конфигурация / админка
1. Управление API-ключами (Git, Confluence)
2. Настройка шаблонов документов
3. Управление пользователями и ролями
4. Настройка параметров LLM (temperature, max_tokens), выбор и подзагрузка самой модели
5. Мониторинг производительности и статистика
6. Настройка правил модерации

### 3.10 Ограничения контента
1. Запрет на генерацию контента, не связанного с предметной областью
2. Блокировка запросов, нарушающих корпоративные политики

### 3.11 Логирование и аудит
1. Структурированное логирование в JSON-формате
2. Запись всех пользовательских запросов и ответов системы
3. Логирование ошибок и исключительных ситуаций
4. Аудит изменений статусов документов
5. Хранение логов в Elasticsearch для анализа

## 4. Нефункциональные требования

### 4.1 Производительность
1. Время полного цикла генерации документа: ≤ 3 минут
2. Время ответа API (без учета генерации LLM): ≤ 1 секунды
3. Время семантического поиска: ≤ 2 секунды
4. Обработка до 10 одновременных запросов на генерацию
5. Поддержка до 50 активных пользователей

### 4.2 Доступность
1. Время доступности системы 24/7
2. Время восстановления после сбоя: ≤ 15 минут
3. Автоматический мониторинг здоровья компонентов
4. Резервное копирование данных

### 4.3 Безопасность
1. Все компоненты развертываются в изолированной корпоративной среде
2. Запрет на передачу данных во внешние сервисы (кроме разрешенных)
3. Защищенное API или локальные нейронные сети

### 4.4 Масштабируемость
1. Горизонтальное масштабирование компонентов
2. Динамическое распределение нагрузки
3. Поддержка увеличения объема данных без потери производительности

## 5. Ограничения и риски

### 5.1 Технические ограничения
1. Использование локальной LLM (Ollama) ограничивает возможности по сравнению с облачными API
2. Зависимость от доступности и качества внешних источников знаний
3. Требования к аппаратным ресурсам для работы LLM
4. Необходимость регулярного обновления индексов векторной БД

### 5.2 Регуляторные ограничения
1. Все данные должны обрабатываться в пределах корпоративного периметра
2. Соответствие требованиям защиты персональных данных при использовании мессенджеров

### 5.3 Риски проекта
1. Недостаточное качество данных в источниках знаний может привести к генерации неточных документов
2. Высокие требования к вычислительным ресурсам для работы LLM
3. Сложность поддержания актуальности индексов при частых изменениях в источниках

## 6. Архитектура решения

### 6.1 Стек разработки
1. Бэкенд: Python 3.9+, FastAPI, SQLAlchemy, Alembic
2. Фронтенд: React, TypeScript, Modern CSS
3. Базы данных: PostgreSQL, ChromaDB/Qdrant, Redis
4. LLM: Ollama с моделями llama3, mistral
5. Интеграции: PyGithub, atlassian-python-api, python-docx
6. Контейнеризация: Docker, Docker Compose
7. Мониторинг: Grafana

### 6.2 Варианты развертывания
1. On-premise: Развертывание на собственных серверах компании
2. Изолированная среда: Все компоненты работают внутри корпоративного периметра

### 6.3 LLM (вариативно)
1. Тип: Локальная (Self-hosted)
2. Провайдер: Ollama
3. Модели: llama3 (основная), mistral (альтернативная)
4. Развертывание: Локальный сервер Ollama

### 6.4 Оборудование
1. Win 11
2. 8+ ядер CPU
3. 32+ ГБ ОЗУ (рекомендуется 64+ ГБ для работы с LLM)
4. Дисковое пространство: 100+ ГБ SSD
5. GPU - 1050 TI - минимально
6. Сетевое подключение: 1+ Гбит/с

## 7. Пользователи и сценарии использования

### 7.1 Кто будет конечным пользователем решения?
**Внутренние:**
1. Технические писатели
2. Разработчики
3. Бизнес-аналитики
4. Менеджеры проектов
5. Руководители отделов

**Внешние:**
1. Сотрудники
2. Инженеры
3. Технические специалисты
4. Диспетчеры
5. Руководители

### 7.2 Опишите типичный сценарий использования
Технический писатель получает задание создать руководство пользователя для нового модуля системы АСУ ПГР. Через веб-интерфейс системы он вводит запрос: 'Создай руководство пользователя для модуля аналитики горных работ'. Система анализирует запрос, определяет тип документа 'manual', извлекает релевантную информацию из Git-репозитория с описаниями модулей и страниц Confluence с бизнес-процессами. Через 2-3 минуты пользователь получает готовый .docx файл с структурированным руководством, содержащим основные разделы: Введение, Начало работы, Основные функции, Решение проблем

## 8. Источники и форматы данных

### 8.1 Какие данные или источники информации уже есть?
1. Git-репозитории: Структурированная база знаний с директориями architecture/, blocks/, functions/, glossary/, user_scenarios/
2. Confluence: Корпоративная вики-система с технической документацией, бизнес-процессами, политиками и стандартами
3. Утвержденные документы: Ранее сгенерированные и утвержденные системой документы

### 8.2 В каком формате предоставляются данные?
1. Git: Markdown, текстовые файлы, различные кодировки
2. Confluence: HTML-разметка, таблицы, изображения
3. Векторная БД: Эмбеддинги текстовых чанков
4. SQL БД: Структурированные метаданные

## 9. Требования к интеграции

### 9.1 С какими существующими системами необходимо интегрироваться?
Не требуется

### 9.2 Какой способ взаимодействия с системой предпочтителен?
1. Окно поддержки на сайте: Веб-интерфейс (React)
2. Бот в мессенджерах: Telegram-бот (временное решение)
3. REST API для программного взаимодействия
4. CLI-утилита для разработчиков и автоматизации
5. Iframe-виджет для встраивания в корпоративные порталы

## 10. Сроки реализации

### 10.1 Когда планируется реализация проекта?
*не заполнено*

### 10.2 Есть ли фиксированные сроки/дедлайн?
*не заполнено*

## 11. Дополнительные материалы и комментарии

### 11.1 Любые дополнительные комментарии или важная информация
1. Чат-интерфейс должен поддерживать dark mode
2. Система должна быть ориентирована на конкретную предметную область (Горно-добывающая промышленность)
3. Необходима возможность постепенного расширения функциональности
4. Важность удобства интерфейса для технических писателей